
declare module "repl" {
    import { AsyncCompleter, Completer, Interface } from "node:readline";
    import { Context } from "node:vm";
    import { InspectOptions } from "node:util";
    interface ReplOptions {
        
        prompt?: string | undefined;
        
        input?: NodeJS.ReadableStream | undefined;
        
        output?: NodeJS.WritableStream | undefined;
        
        terminal?: boolean | undefined;
        
        eval?: REPLEval | undefined;
        
        preview?: boolean | undefined;
        
        useColors?: boolean | undefined;
        
        useGlobal?: boolean | undefined;
        
        ignoreUndefined?: boolean | undefined;
        
        writer?: REPLWriter | undefined;
        
        completer?: Completer | AsyncCompleter | undefined;
        
        replMode?: typeof REPL_MODE_SLOPPY | typeof REPL_MODE_STRICT | undefined;
        
        breakEvalOnSigint?: boolean | undefined;
    }
    type REPLEval = (
        this: REPLServer,
        evalCmd: string,
        context: Context,
        file: string,
        cb: (err: Error | null, result: any) => void,
    ) => void;
    type REPLWriter = (this: REPLServer, obj: any) => string;
    
    const writer: REPLWriter & {
        options: InspectOptions;
    };
    type REPLCommandAction = (this: REPLServer, text: string) => void;
    interface REPLCommand {
        
        help?: string | undefined;
        
        action: REPLCommandAction;
    }
    interface REPLServerSetupHistoryOptions {
        filePath?: string | undefined;
        size?: number | undefined;
        removeHistoryDuplicates?: boolean | undefined;
        onHistoryFileLoaded?: ((err: Error | null, repl: REPLServer) => void) | undefined;
    }
    
    class REPLServer extends Interface {
        
        readonly context: Context;
        
        readonly inputStream: NodeJS.ReadableStream;
        
        readonly outputStream: NodeJS.WritableStream;
        
        readonly input: NodeJS.ReadableStream;
        
        readonly output: NodeJS.WritableStream;
        
        readonly commands: NodeJS.ReadOnlyDict<REPLCommand>;
        
        readonly editorMode: boolean;
        
        readonly underscoreAssigned: boolean;
        
        readonly last: any;
        
        readonly underscoreErrAssigned: boolean;
        
        readonly lastError: any;
        
        readonly eval: REPLEval;
        
        readonly useColors: boolean;
        
        readonly useGlobal: boolean;
        
        readonly ignoreUndefined: boolean;
        
        readonly writer: REPLWriter;
        
        readonly completer: Completer | AsyncCompleter;
        
        readonly replMode: typeof REPL_MODE_SLOPPY | typeof REPL_MODE_STRICT;
        
        private constructor();
        
        defineCommand(keyword: string, cmd: REPLCommandAction | REPLCommand): void;
        
        displayPrompt(preserveCursor?: boolean): void;
        
        clearBufferedCommand(): void;
        
        setupHistory(historyPath: string, callback: (err: Error | null, repl: this) => void): void;
        setupHistory(
            historyConfig?: REPLServerSetupHistoryOptions,
            callback?: (err: Error | null, repl: this) => void,
        ): void;
        
        addListener(event: string, listener: (...args: any[]) => void): this;
        addListener(event: "close", listener: () => void): this;
        addListener(event: "line", listener: (input: string) => void): this;
        addListener(event: "pause", listener: () => void): this;
        addListener(event: "resume", listener: () => void): this;
        addListener(event: "SIGCONT", listener: () => void): this;
        addListener(event: "SIGINT", listener: () => void): this;
        addListener(event: "SIGTSTP", listener: () => void): this;
        addListener(event: "exit", listener: () => void): this;
        addListener(event: "reset", listener: (context: Context) => void): this;
        emit(event: string | symbol, ...args: any[]): boolean;
        emit(event: "close"): boolean;
        emit(event: "line", input: string): boolean;
        emit(event: "pause"): boolean;
        emit(event: "resume"): boolean;
        emit(event: "SIGCONT"): boolean;
        emit(event: "SIGINT"): boolean;
        emit(event: "SIGTSTP"): boolean;
        emit(event: "exit"): boolean;
        emit(event: "reset", context: Context): boolean;
        on(event: string, listener: (...args: any[]) => void): this;
        on(event: "close", listener: () => void): this;
        on(event: "line", listener: (input: string) => void): this;
        on(event: "pause", listener: () => void): this;
        on(event: "resume", listener: () => void): this;
        on(event: "SIGCONT", listener: () => void): this;
        on(event: "SIGINT", listener: () => void): this;
        on(event: "SIGTSTP", listener: () => void): this;
        on(event: "exit", listener: () => void): this;
        on(event: "reset", listener: (context: Context) => void): this;
        once(event: string, listener: (...args: any[]) => void): this;
        once(event: "close", listener: () => void): this;
        once(event: "line", listener: (input: string) => void): this;
        once(event: "pause", listener: () => void): this;
        once(event: "resume", listener: () => void): this;
        once(event: "SIGCONT", listener: () => void): this;
        once(event: "SIGINT", listener: () => void): this;
        once(event: "SIGTSTP", listener: () => void): this;
        once(event: "exit", listener: () => void): this;
        once(event: "reset", listener: (context: Context) => void): this;
        prependListener(event: string, listener: (...args: any[]) => void): this;
        prependListener(event: "close", listener: () => void): this;
        prependListener(event: "line", listener: (input: string) => void): this;
        prependListener(event: "pause", listener: () => void): this;
        prependListener(event: "resume", listener: () => void): this;
        prependListener(event: "SIGCONT", listener: () => void): this;
        prependListener(event: "SIGINT", listener: () => void): this;
        prependListener(event: "SIGTSTP", listener: () => void): this;
        prependListener(event: "exit", listener: () => void): this;
        prependListener(event: "reset", listener: (context: Context) => void): this;
        prependOnceListener(event: string, listener: (...args: any[]) => void): this;
        prependOnceListener(event: "close", listener: () => void): this;
        prependOnceListener(event: "line", listener: (input: string) => void): this;
        prependOnceListener(event: "pause", listener: () => void): this;
        prependOnceListener(event: "resume", listener: () => void): this;
        prependOnceListener(event: "SIGCONT", listener: () => void): this;
        prependOnceListener(event: "SIGINT", listener: () => void): this;
        prependOnceListener(event: "SIGTSTP", listener: () => void): this;
        prependOnceListener(event: "exit", listener: () => void): this;
        prependOnceListener(event: "reset", listener: (context: Context) => void): this;
    }
    
    const REPL_MODE_SLOPPY: unique symbol;
    
    const REPL_MODE_STRICT: unique symbol;
    
    function start(options?: string | ReplOptions): REPLServer;
    
    class Recoverable extends SyntaxError {
        err: Error;
        constructor(err: Error);
    }
}
declare module "node:repl" {
    export * from "repl";
}
