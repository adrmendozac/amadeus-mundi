
declare module "tls" {
    import { X509Certificate } from "node:crypto";
    import * as net from "node:net";
    import * as stream from "stream";
    const CLIENT_RENEG_LIMIT: number;
    const CLIENT_RENEG_WINDOW: number;
    interface Certificate {
        
        C: string;
        
        ST: string;
        
        L: string;
        
        O: string;
        
        OU: string;
        
        CN: string;
    }
    interface PeerCertificate {
        
        ca: boolean;
        
        raw: Buffer;
        
        subject: Certificate;
        
        issuer: Certificate;
        
        valid_from: string;
        
        valid_to: string;
        
        serialNumber: string;
        
        fingerprint: string;
        
        fingerprint256: string;
        
        fingerprint512: string;
        
        ext_key_usage?: string[];
        
        subjectaltname?: string;
        
        infoAccess?: NodeJS.Dict<string[]>;
        
        bits?: number;
        
        exponent?: string;
        
        modulus?: string;
        
        pubkey?: Buffer;
        
        asn1Curve?: string;
        
        nistCurve?: string;
    }
    interface DetailedPeerCertificate extends PeerCertificate {
        
        issuerCertificate: DetailedPeerCertificate;
    }
    interface CipherNameAndProtocol {
        
        name: string;
        
        version: string;
        
        standardName: string;
    }
    interface EphemeralKeyInfo {
        
        type: string;
        
        name?: string | undefined;
        
        size: number;
    }
    interface KeyObject {
        
        pem: string | Buffer;
        
        passphrase?: string | undefined;
    }
    interface PxfObject {
        
        buf: string | Buffer;
        
        passphrase?: string | undefined;
    }
    interface TLSSocketOptions extends SecureContextOptions, CommonConnectionOptions {
        
        isServer?: boolean | undefined;
        
        server?: net.Server | undefined;
        
        session?: Buffer | undefined;
        
        requestOCSP?: boolean | undefined;
    }
    
    class TLSSocket extends net.Socket {
        
        constructor(socket: net.Socket | stream.Duplex, options?: TLSSocketOptions);
        
        authorized: boolean;
        
        authorizationError: Error;
        
        encrypted: true;
        
        alpnProtocol: string | false | null;
        
        getCertificate(): PeerCertificate | object | null;
        
        getCipher(): CipherNameAndProtocol;
        
        getEphemeralKeyInfo(): EphemeralKeyInfo | object | null;
        
        getFinished(): Buffer | undefined;
        
        getPeerCertificate(detailed: true): DetailedPeerCertificate;
        getPeerCertificate(detailed?: false): PeerCertificate;
        getPeerCertificate(detailed?: boolean): PeerCertificate | DetailedPeerCertificate;
        
        getPeerFinished(): Buffer | undefined;
        
        getProtocol(): string | null;
        
        getSession(): Buffer | undefined;
        
        getSharedSigalgs(): string[];
        
        getTLSTicket(): Buffer | undefined;
        
        isSessionReused(): boolean;
        
        renegotiate(
            options: {
                rejectUnauthorized?: boolean | undefined;
                requestCert?: boolean | undefined;
            },
            callback: (err: Error | null) => void,
        ): undefined | boolean;
        
        setKeyCert(context: SecureContextOptions | SecureContext): void;
        
        setMaxSendFragment(size: number): boolean;
        
        disableRenegotiation(): void;
        
        enableTrace(): void;
        
        getPeerX509Certificate(): X509Certificate | undefined;
        
        getX509Certificate(): X509Certificate | undefined;
        
        exportKeyingMaterial(length: number, label: string, context: Buffer): Buffer;
        addListener(event: string, listener: (...args: any[]) => void): this;
        addListener(event: "OCSPResponse", listener: (response: Buffer) => void): this;
        addListener(event: "secureConnect", listener: () => void): this;
        addListener(event: "session", listener: (session: Buffer) => void): this;
        addListener(event: "keylog", listener: (line: Buffer) => void): this;
        emit(event: string | symbol, ...args: any[]): boolean;
        emit(event: "OCSPResponse", response: Buffer): boolean;
        emit(event: "secureConnect"): boolean;
        emit(event: "session", session: Buffer): boolean;
        emit(event: "keylog", line: Buffer): boolean;
        on(event: string, listener: (...args: any[]) => void): this;
        on(event: "OCSPResponse", listener: (response: Buffer) => void): this;
        on(event: "secureConnect", listener: () => void): this;
        on(event: "session", listener: (session: Buffer) => void): this;
        on(event: "keylog", listener: (line: Buffer) => void): this;
        once(event: string, listener: (...args: any[]) => void): this;
        once(event: "OCSPResponse", listener: (response: Buffer) => void): this;
        once(event: "secureConnect", listener: () => void): this;
        once(event: "session", listener: (session: Buffer) => void): this;
        once(event: "keylog", listener: (line: Buffer) => void): this;
        prependListener(event: string, listener: (...args: any[]) => void): this;
        prependListener(event: "OCSPResponse", listener: (response: Buffer) => void): this;
        prependListener(event: "secureConnect", listener: () => void): this;
        prependListener(event: "session", listener: (session: Buffer) => void): this;
        prependListener(event: "keylog", listener: (line: Buffer) => void): this;
        prependOnceListener(event: string, listener: (...args: any[]) => void): this;
        prependOnceListener(event: "OCSPResponse", listener: (response: Buffer) => void): this;
        prependOnceListener(event: "secureConnect", listener: () => void): this;
        prependOnceListener(event: "session", listener: (session: Buffer) => void): this;
        prependOnceListener(event: "keylog", listener: (line: Buffer) => void): this;
    }
    interface CommonConnectionOptions {
        
        secureContext?: SecureContext | undefined;
        
        enableTrace?: boolean | undefined;
        
        requestCert?: boolean | undefined;
        
        ALPNProtocols?: string[] | Uint8Array[] | Uint8Array | undefined;
        
        SNICallback?: ((servername: string, cb: (err: Error | null, ctx?: SecureContext) => void) => void) | undefined;
        
        rejectUnauthorized?: boolean | undefined;
    }
    interface TlsOptions extends SecureContextOptions, CommonConnectionOptions, net.ServerOpts {
        
        handshakeTimeout?: number | undefined;
        
        sessionTimeout?: number | undefined;
        
        ticketKeys?: Buffer | undefined;
        
        pskCallback?: ((socket: TLSSocket, identity: string) => NodeJS.ArrayBufferView | null) | undefined;
        
        pskIdentityHint?: string | undefined;
    }
    interface PSKCallbackNegotation {
        psk: DataView | NodeJS.TypedArray;
        identity: string;
    }
    interface ConnectionOptions extends SecureContextOptions, CommonConnectionOptions {
        host?: string | undefined;
        port?: number | undefined;
        path?: string | undefined; 
        socket?: stream.Duplex | undefined; 
        checkServerIdentity?: typeof checkServerIdentity | undefined;
        servername?: string | undefined; 
        session?: Buffer | undefined;
        minDHSize?: number | undefined;
        lookup?: net.LookupFunction | undefined;
        timeout?: number | undefined;
        
        pskCallback?: ((hint: string | null) => PSKCallbackNegotation | null) | undefined;
    }
    
    class Server extends net.Server {
        constructor(secureConnectionListener?: (socket: TLSSocket) => void);
        constructor(options: TlsOptions, secureConnectionListener?: (socket: TLSSocket) => void);
        
        addContext(hostname: string, context: SecureContextOptions | SecureContext): void;
        
        getTicketKeys(): Buffer;
        
        setSecureContext(options: SecureContextOptions): void;
        
        setTicketKeys(keys: Buffer): void;
        
        addListener(event: string, listener: (...args: any[]) => void): this;
        addListener(event: "tlsClientError", listener: (err: Error, tlsSocket: TLSSocket) => void): this;
        addListener(
            event: "newSession",
            listener: (sessionId: Buffer, sessionData: Buffer, callback: () => void) => void,
        ): this;
        addListener(
            event: "OCSPRequest",
            listener: (
                certificate: Buffer,
                issuer: Buffer,
                callback: (err: Error | null, resp: Buffer) => void,
            ) => void,
        ): this;
        addListener(
            event: "resumeSession",
            listener: (sessionId: Buffer, callback: (err: Error | null, sessionData: Buffer | null) => void) => void,
        ): this;
        addListener(event: "secureConnection", listener: (tlsSocket: TLSSocket) => void): this;
        addListener(event: "keylog", listener: (line: Buffer, tlsSocket: TLSSocket) => void): this;
        emit(event: string | symbol, ...args: any[]): boolean;
        emit(event: "tlsClientError", err: Error, tlsSocket: TLSSocket): boolean;
        emit(event: "newSession", sessionId: Buffer, sessionData: Buffer, callback: () => void): boolean;
        emit(
            event: "OCSPRequest",
            certificate: Buffer,
            issuer: Buffer,
            callback: (err: Error | null, resp: Buffer) => void,
        ): boolean;
        emit(
            event: "resumeSession",
            sessionId: Buffer,
            callback: (err: Error | null, sessionData: Buffer | null) => void,
        ): boolean;
        emit(event: "secureConnection", tlsSocket: TLSSocket): boolean;
        emit(event: "keylog", line: Buffer, tlsSocket: TLSSocket): boolean;
        on(event: string, listener: (...args: any[]) => void): this;
        on(event: "tlsClientError", listener: (err: Error, tlsSocket: TLSSocket) => void): this;
        on(event: "newSession", listener: (sessionId: Buffer, sessionData: Buffer, callback: () => void) => void): this;
        on(
            event: "OCSPRequest",
            listener: (
                certificate: Buffer,
                issuer: Buffer,
                callback: (err: Error | null, resp: Buffer) => void,
            ) => void,
        ): this;
        on(
            event: "resumeSession",
            listener: (sessionId: Buffer, callback: (err: Error | null, sessionData: Buffer | null) => void) => void,
        ): this;
        on(event: "secureConnection", listener: (tlsSocket: TLSSocket) => void): this;
        on(event: "keylog", listener: (line: Buffer, tlsSocket: TLSSocket) => void): this;
        once(event: string, listener: (...args: any[]) => void): this;
        once(event: "tlsClientError", listener: (err: Error, tlsSocket: TLSSocket) => void): this;
        once(
            event: "newSession",
            listener: (sessionId: Buffer, sessionData: Buffer, callback: () => void) => void,
        ): this;
        once(
            event: "OCSPRequest",
            listener: (
                certificate: Buffer,
                issuer: Buffer,
                callback: (err: Error | null, resp: Buffer) => void,
            ) => void,
        ): this;
        once(
            event: "resumeSession",
            listener: (sessionId: Buffer, callback: (err: Error | null, sessionData: Buffer | null) => void) => void,
        ): this;
        once(event: "secureConnection", listener: (tlsSocket: TLSSocket) => void): this;
        once(event: "keylog", listener: (line: Buffer, tlsSocket: TLSSocket) => void): this;
        prependListener(event: string, listener: (...args: any[]) => void): this;
        prependListener(event: "tlsClientError", listener: (err: Error, tlsSocket: TLSSocket) => void): this;
        prependListener(
            event: "newSession",
            listener: (sessionId: Buffer, sessionData: Buffer, callback: () => void) => void,
        ): this;
        prependListener(
            event: "OCSPRequest",
            listener: (
                certificate: Buffer,
                issuer: Buffer,
                callback: (err: Error | null, resp: Buffer) => void,
            ) => void,
        ): this;
        prependListener(
            event: "resumeSession",
            listener: (sessionId: Buffer, callback: (err: Error | null, sessionData: Buffer | null) => void) => void,
        ): this;
        prependListener(event: "secureConnection", listener: (tlsSocket: TLSSocket) => void): this;
        prependListener(event: "keylog", listener: (line: Buffer, tlsSocket: TLSSocket) => void): this;
        prependOnceListener(event: string, listener: (...args: any[]) => void): this;
        prependOnceListener(event: "tlsClientError", listener: (err: Error, tlsSocket: TLSSocket) => void): this;
        prependOnceListener(
            event: "newSession",
            listener: (sessionId: Buffer, sessionData: Buffer, callback: () => void) => void,
        ): this;
        prependOnceListener(
            event: "OCSPRequest",
            listener: (
                certificate: Buffer,
                issuer: Buffer,
                callback: (err: Error | null, resp: Buffer) => void,
            ) => void,
        ): this;
        prependOnceListener(
            event: "resumeSession",
            listener: (sessionId: Buffer, callback: (err: Error | null, sessionData: Buffer | null) => void) => void,
        ): this;
        prependOnceListener(event: "secureConnection", listener: (tlsSocket: TLSSocket) => void): this;
        prependOnceListener(event: "keylog", listener: (line: Buffer, tlsSocket: TLSSocket) => void): this;
    }
    type SecureVersion = "TLSv1.3" | "TLSv1.2" | "TLSv1.1" | "TLSv1";
    interface SecureContextOptions {
        
        ALPNCallback?: ((arg: { servername: string; protocols: string[] }) => string | undefined) | undefined;
        
        allowPartialTrustChain?: boolean | undefined;
        
        ca?: string | Buffer | Array<string | Buffer> | undefined;
        
        cert?: string | Buffer | Array<string | Buffer> | undefined;
        
        sigalgs?: string | undefined;
        
        ciphers?: string | undefined;
        
        clientCertEngine?: string | undefined;
        
        crl?: string | Buffer | Array<string | Buffer> | undefined;
        
        dhparam?: string | Buffer | undefined;
        
        ecdhCurve?: string | undefined;
        
        honorCipherOrder?: boolean | undefined;
        
        key?: string | Buffer | Array<string | Buffer | KeyObject> | undefined;
        
        privateKeyEngine?: string | undefined;
        
        privateKeyIdentifier?: string | undefined;
        
        maxVersion?: SecureVersion | undefined;
        
        minVersion?: SecureVersion | undefined;
        
        passphrase?: string | undefined;
        
        pfx?: string | Buffer | Array<string | Buffer | PxfObject> | undefined;
        
        secureOptions?: number | undefined; 
        
        secureProtocol?: string | undefined;
        
        sessionIdContext?: string | undefined;
        
        ticketKeys?: Buffer | undefined;
        
        sessionTimeout?: number | undefined;
    }
    interface SecureContext {
        context: any;
    }
    
    function checkServerIdentity(hostname: string, cert: PeerCertificate): Error | undefined;
    
    function createServer(secureConnectionListener?: (socket: TLSSocket) => void): Server;
    function createServer(options: TlsOptions, secureConnectionListener?: (socket: TLSSocket) => void): Server;
    
    function connect(options: ConnectionOptions, secureConnectListener?: () => void): TLSSocket;
    function connect(
        port: number,
        host?: string,
        options?: ConnectionOptions,
        secureConnectListener?: () => void,
    ): TLSSocket;
    function connect(port: number, options?: ConnectionOptions, secureConnectListener?: () => void): TLSSocket;
    
    function createSecureContext(options?: SecureContextOptions): SecureContext;
    
    function getCACertificates(type?: "default" | "system" | "bundled" | "extra"): string[];
    
    function getCiphers(): string[];
    
    function setDefaultCACertificates(certs: ReadonlyArray<string | NodeJS.ArrayBufferView>): void;
    
    let DEFAULT_ECDH_CURVE: string;
    
    let DEFAULT_MAX_VERSION: SecureVersion;
    
    let DEFAULT_MIN_VERSION: SecureVersion;
    
    let DEFAULT_CIPHERS: string;
    
    const rootCertificates: readonly string[];
}
declare module "node:tls" {
    export * from "tls";
}
