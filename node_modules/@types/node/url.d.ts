
declare module "url" {
    import { Blob as NodeBlob } from "node:buffer";
    import { ClientRequestArgs } from "node:http";
    import { ParsedUrlQuery, ParsedUrlQueryInput } from "node:querystring";
    
    interface UrlObject {
        auth?: string | null | undefined;
        hash?: string | null | undefined;
        host?: string | null | undefined;
        hostname?: string | null | undefined;
        href?: string | null | undefined;
        pathname?: string | null | undefined;
        protocol?: string | null | undefined;
        search?: string | null | undefined;
        slashes?: boolean | null | undefined;
        port?: string | number | null | undefined;
        query?: string | null | ParsedUrlQueryInput | undefined;
    }
    
    interface Url {
        auth: string | null;
        hash: string | null;
        host: string | null;
        hostname: string | null;
        href: string;
        path: string | null;
        pathname: string | null;
        protocol: string | null;
        search: string | null;
        slashes: boolean | null;
        port: string | null;
        query: string | null | ParsedUrlQuery;
    }
    interface UrlWithParsedQuery extends Url {
        query: ParsedUrlQuery;
    }
    interface UrlWithStringQuery extends Url {
        query: string | null;
    }
    interface FileUrlToPathOptions {
        
        windows?: boolean | undefined;
    }
    interface PathToFileUrlOptions {
        
        windows?: boolean | undefined;
    }
    
    function parse(urlString: string): UrlWithStringQuery;
    function parse(
        urlString: string,
        parseQueryString: false | undefined,
        slashesDenoteHost?: boolean,
    ): UrlWithStringQuery;
    function parse(urlString: string, parseQueryString: true, slashesDenoteHost?: boolean): UrlWithParsedQuery;
    function parse(urlString: string, parseQueryString: boolean, slashesDenoteHost?: boolean): Url;
    
    function format(urlObject: URL, options?: URLFormatOptions): string;
    
    function format(urlObject: UrlObject | string): string;
    
    function resolve(from: string, to: string): string;
    
    function domainToASCII(domain: string): string;
    
    function domainToUnicode(domain: string): string;
    
    function fileURLToPath(url: string | URL, options?: FileUrlToPathOptions): string;
    
    function fileURLToPathBuffer(url: string | URL, options?: FileUrlToPathOptions): Buffer;
    
    function pathToFileURL(path: string, options?: PathToFileUrlOptions): URL;
    
    function urlToHttpOptions(url: URL): ClientRequestArgs;
    interface URLFormatOptions {
        
        auth?: boolean | undefined;
        
        fragment?: boolean | undefined;
        
        search?: boolean | undefined;
        
        unicode?: boolean | undefined;
    }
    
    class URL {
        
        static createObjectURL(blob: NodeBlob): string;
        
        static revokeObjectURL(id: string): void;
        
        static canParse(input: string, base?: string): boolean;
        
        static parse(input: string, base?: string): URL | null;
        constructor(input: string | { toString: () => string }, base?: string | URL);
        
        hash: string;
        
        host: string;
        
        hostname: string;
        
        href: string;
        
        readonly origin: string;
        
        password: string;
        
        pathname: string;
        
        port: string;
        
        protocol: string;
        
        search: string;
        
        readonly searchParams: URLSearchParams;
        
        username: string;
        
        toString(): string;
        
        toJSON(): string;
    }
    interface URLPatternComponentResult {
        input: string;
        groups: Record<string, string | undefined>;
    }
    interface URLPatternInit {
        protocol?: string;
        username?: string;
        password?: string;
        hostname?: string;
        port?: string;
        pathname?: string;
        search?: string;
        hash?: string;
        baseURL?: string;
    }
    interface URLPatternOptions {
        ignoreCase?: boolean;
    }
    interface URLPatternResult {
        inputs: (string | URLPatternInit)[];
        protocol: URLPatternComponentResult;
        username: URLPatternComponentResult;
        password: URLPatternComponentResult;
        hostname: URLPatternComponentResult;
        port: URLPatternComponentResult;
        pathname: URLPatternComponentResult;
        search: URLPatternComponentResult;
        hash: URLPatternComponentResult;
    }
    
    class URLPattern {
        constructor(input: string | URLPatternInit, baseURL: string, options?: URLPatternOptions);
        constructor(input?: string | URLPatternInit, options?: URLPatternOptions);
        exec(input?: string | URLPatternInit, baseURL?: string): URLPatternResult | null;
        readonly hasRegExpGroups: boolean;
        readonly hash: string;
        readonly hostname: string;
        readonly password: string;
        readonly pathname: string;
        readonly port: string;
        readonly protocol: string;
        readonly search: string;
        test(input?: string | URLPatternInit, baseURL?: string): boolean;
        readonly username: string;
    }
    interface URLSearchParamsIterator<T> extends NodeJS.Iterator<T, NodeJS.BuiltinIteratorReturn, unknown> {
        [Symbol.iterator](): URLSearchParamsIterator<T>;
    }
    
    class URLSearchParams implements Iterable<[string, string]> {
        constructor(
            init?:
                | URLSearchParams
                | string
                | Record<string, string | readonly string[]>
                | Iterable<[string, string]>
                | ReadonlyArray<[string, string]>,
        );
        
        append(name: string, value: string): void;
        
        delete(name: string, value?: string): void;
        
        entries(): URLSearchParamsIterator<[string, string]>;
        
        forEach<TThis = this>(
            fn: (this: TThis, value: string, name: string, searchParams: URLSearchParams) => void,
            thisArg?: TThis,
        ): void;
        
        get(name: string): string | null;
        
        getAll(name: string): string[];
        
        has(name: string, value?: string): boolean;
        
        keys(): URLSearchParamsIterator<string>;
        
        set(name: string, value: string): void;
        
        readonly size: number;
        
        sort(): void;
        
        toString(): string;
        
        values(): URLSearchParamsIterator<string>;
        [Symbol.iterator](): URLSearchParamsIterator<[string, string]>;
    }
    import {
        URL as _URL,
        URLPattern as _URLPattern,
        URLPatternInit as _URLPatternInit,
        URLPatternResult as _URLPatternResult,
        URLSearchParams as _URLSearchParams,
    } from "url";
    global {
        interface URL extends _URL {}
        var URL: typeof globalThis extends {
            onmessage: any;
            URL: infer T;
        } ? T
            : typeof _URL;
        interface URLSearchParams extends _URLSearchParams {}
        var URLSearchParams: typeof globalThis extends {
            onmessage: any;
            URLSearchParams: infer T;
        } ? T
            : typeof _URLSearchParams;
        interface URLPatternInit extends _URLPatternInit {}
        interface URLPatternResult extends _URLPatternResult {}
        interface URLPattern extends _URLPattern {}
        var URLPattern: typeof globalThis extends {
            onmessage: any;
            scheduler: any; 
            URLPattern: infer T;
        } ? T
            : typeof _URLPattern;
    }
}
declare module "node:url" {
    export * from "url";
}
