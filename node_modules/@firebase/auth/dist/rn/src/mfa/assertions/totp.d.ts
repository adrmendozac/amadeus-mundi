
import { TotpMultiFactorAssertion, MultiFactorSession } from '../../model/public_types';
import { AuthInternal } from '../../model/auth';
import { StartTotpMfaEnrollmentResponse, TotpVerificationInfo } from '../../api/account_management/mfa';
import { FinalizeMfaResponse } from '../../api/authentication/mfa';
import { MultiFactorAssertionImpl } from '../../mfa/mfa_assertion';

export declare class TotpMultiFactorGenerator {
    
    static assertionForEnrollment(secret: TotpSecret, oneTimePassword: string): TotpMultiFactorAssertion;
    
    static assertionForSignIn(enrollmentId: string, oneTimePassword: string): TotpMultiFactorAssertion;
    
    static generateSecret(session: MultiFactorSession): Promise<TotpSecret>;
    
    static FACTOR_ID: 'totp';
}
export declare class TotpMultiFactorAssertionImpl extends MultiFactorAssertionImpl implements TotpMultiFactorAssertion {
    readonly otp: string;
    readonly enrollmentId?: string | undefined;
    readonly secret?: TotpSecret | undefined;
    constructor(otp: string, enrollmentId?: string | undefined, secret?: TotpSecret | undefined);
    
    static _fromSecret(secret: TotpSecret, otp: string): TotpMultiFactorAssertionImpl;
    
    static _fromEnrollmentId(enrollmentId: string, otp: string): TotpMultiFactorAssertionImpl;
    
    _finalizeEnroll(auth: AuthInternal, idToken: string, displayName?: string | null): Promise<FinalizeMfaResponse>;
    
    _finalizeSignIn(auth: AuthInternal, mfaPendingCredential: string): Promise<FinalizeMfaResponse>;
}

export declare class TotpSecret {
    private readonly sessionInfo;
    private readonly auth;
    
    readonly secretKey: string;
    
    readonly hashingAlgorithm: string;
    
    readonly codeLength: number;
    
    readonly codeIntervalSeconds: number;
    
    readonly enrollmentCompletionDeadline: string;
    private constructor();
    
    static _fromStartTotpMfaEnrollmentResponse(response: StartTotpMfaEnrollmentResponse, auth: AuthInternal): TotpSecret;
    
    _makeTotpVerificationInfo(otp: string): TotpVerificationInfo;
    
    generateQrCodeUrl(accountName?: string, issuer?: string): string;
}
