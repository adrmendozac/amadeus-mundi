
import { FirebaseApp, FirebaseError } from '@firebase/app';

export interface RemoteConfig {
    
    app: FirebaseApp;
    
    settings: RemoteConfigSettings;
    
    defaultConfig: {
        [key: string]: string | number | boolean;
    };
    
    fetchTimeMillis: number;
    
    lastFetchStatus: FetchStatus;
}

export interface FirebaseRemoteConfigObject {
    [key: string]: string;
}

export interface FetchResponse {
    
    status: number;
    
    eTag?: string;
    
    config?: FirebaseRemoteConfigObject;
    
    templateVersion?: number;
}

export interface RemoteConfigOptions {
    
    templateId?: string;
    
    initialFetchResponse?: FetchResponse;
}

export type ValueSource = 'static' | 'default' | 'remote';

export interface Value {
    
    asBoolean(): boolean;
    
    asNumber(): number;
    
    asString(): string;
    
    getSource(): ValueSource;
}

export interface RemoteConfigSettings {
    
    minimumFetchIntervalMillis: number;
    
    fetchTimeoutMillis: number;
}

export type FetchStatus = 'no-fetch-yet' | 'success' | 'failure' | 'throttle';

export type LogLevel = 'debug' | 'error' | 'silent';

export interface CustomSignals {
    [key: string]: string | number | null;
}

export interface ConfigUpdate {
    
    getUpdatedKeys(): Set<string>;
}

export interface ConfigUpdateObserver {
    
    next: (configUpdate: ConfigUpdate) => void;
    
    error: (error: FirebaseError) => void;
    
    complete: () => void;
}

export type Unsubscribe = () => void;

export type FetchType = 'BASE' | 'REALTIME';
declare module '@firebase/component' {
    interface NameServiceMapping {
        'remote-config': RemoteConfig;
    }
}
