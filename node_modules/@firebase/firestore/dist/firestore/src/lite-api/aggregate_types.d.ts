
import { AggregateType } from '../core/aggregate';
import { FieldPath as InternalFieldPath } from '../model/path';
import { ApiClientObjectMap, Value } from '../protos/firestore_proto_api';
import { average, count, sum } from './aggregate';
import { DocumentData, Query } from './reference';
import { AbstractUserDataWriter } from './user_data_writer';
export { AggregateType };

export declare class AggregateField<T> {
    readonly _internalFieldPath?: InternalFieldPath | undefined;
    
    readonly type = "AggregateField";
    
    readonly aggregateType: AggregateType;
    
    constructor(aggregateType?: AggregateType, _internalFieldPath?: InternalFieldPath | undefined);
}

export type AggregateFieldType = ReturnType<typeof sum> | ReturnType<typeof average> | ReturnType<typeof count>;

export interface AggregateSpec {
    [field: string]: AggregateFieldType;
}

export type AggregateSpecData<T extends AggregateSpec> = {
    [P in keyof T]: T[P] extends AggregateField<infer U> ? U : never;
};

export declare class AggregateQuerySnapshot<AggregateSpecType extends AggregateSpec, AppModelType = DocumentData, DbModelType extends DocumentData = DocumentData> {
    private readonly _userDataWriter;
    private readonly _data;
    
    readonly type = "AggregateQuerySnapshot";
    
    readonly query: Query<AppModelType, DbModelType>;
    
    constructor(query: Query<AppModelType, DbModelType>, _userDataWriter: AbstractUserDataWriter, _data: ApiClientObjectMap<Value>);
    
    data(): AggregateSpecData<AggregateSpecType>;
}
