
import { QueryResult } from '../local/local_store_impl';
import { DocumentKeySet, DocumentMap } from '../model/collections';
import { DocumentKey } from '../model/document_key';
import { DocumentSet } from '../model/document_set';
import { TargetChange } from '../remote/remote_event';
import { Query } from './query';
import { OnlineState } from './types';
import { DocumentChangeSet, ViewSnapshot } from './view_snapshot';
export type LimboDocumentChange = AddedLimboDocument | RemovedLimboDocument;
export declare class AddedLimboDocument {
    key: DocumentKey;
    constructor(key: DocumentKey);
}
export declare class RemovedLimboDocument {
    key: DocumentKey;
    constructor(key: DocumentKey);
}

export interface ViewDocumentChanges {
    
    documentSet: DocumentSet;
    
    changeSet: DocumentChangeSet;
    
    needsRefill: boolean;
    mutatedKeys: DocumentKeySet;
}
export interface ViewChange {
    snapshot?: ViewSnapshot;
    limboChanges: LimboDocumentChange[];
}

export declare class View {
    private query;
    
    private _syncedDocuments;
    private syncState;
    private hasCachedResults;
    
    private current;
    private documentSet;
    
    private limboDocuments;
    
    private mutatedKeys;
    
    private docComparator;
    constructor(query: Query, 
    
    _syncedDocuments: DocumentKeySet);
    
    get syncedDocuments(): DocumentKeySet;
    
    computeDocChanges(docChanges: DocumentMap, previousChanges?: ViewDocumentChanges): ViewDocumentChanges;
    private shouldWaitForSyncedDocument;
    
    applyChanges(docChanges: ViewDocumentChanges, limboResolutionEnabled: boolean, targetChange?: TargetChange, targetIsPendingReset?: boolean): ViewChange;
    
    applyOnlineStateChange(onlineState: OnlineState): ViewChange;
    
    private shouldBeInLimbo;
    
    private applyTargetChange;
    private updateLimboDocuments;
    
    synchronizeWithPersistedState(queryResult: QueryResult): ViewChange;
    
    computeInitialSnapshot(): ViewSnapshot;
}
