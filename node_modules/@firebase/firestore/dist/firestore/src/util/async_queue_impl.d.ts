
import { AsyncQueue, DelayedOperation, TimerId } from './async_queue';
import { FirestoreError } from './error';
export declare class AsyncQueueImpl implements AsyncQueue {
    private tail;
    private retryableOps;
    private _isShuttingDown;
    private delayedOperations;
    failure: FirestoreError | null;
    private operationInProgress;
    private skipNonRestrictedTasks;
    private timerIdsToSkip;
    private backoff;
    private visibilityHandler;
    constructor(tail?: Promise<unknown>);
    get isShuttingDown(): boolean;
    
    enqueueAndForget<T extends unknown>(op: () => Promise<T>): void;
    enqueueAndForgetEvenWhileRestricted<T extends unknown>(op: () => Promise<T>): void;
    enterRestrictedMode(purgeExistingTasks?: boolean): void;
    enqueue<T extends unknown>(op: () => Promise<T>): Promise<T>;
    enqueueRetryable(op: () => Promise<void>): void;
    
    private retryNextOp;
    private enqueueInternal;
    enqueueAfterDelay<T extends unknown>(timerId: TimerId, delayMs: number, op: () => Promise<T>): DelayedOperation<T>;
    private verifyNotFailed;
    verifyOperationInProgress(): void;
    
    drain(): Promise<void>;
    
    containsDelayedOperation(timerId: TimerId): boolean;
    
    runAllDelayedOperationsUntil(lastTimerId: TimerId): Promise<void>;
    
    skipDelaysForTimerId(timerId: TimerId): void;
    
    private removeDelayedOperation;
}
export declare function newAsyncQueue(): AsyncQueue;
