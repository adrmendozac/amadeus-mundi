
import { BatchId, ListenSequenceNumber, TargetId } from '../core/types';
import { IndexKind } from '../model/field_index';
import { BundledQuery } from '../protos/firestore_bundle_proto';
import { Document as ProtoDocument, DocumentsTarget as ProtoDocumentsTarget, QueryTarget as ProtoQueryTarget, Write as ProtoWrite } from '../protos/firestore_proto_api';
import { EncodedResourcePath } from './encoded_resource_path';
import { DbTimestampKey, KeySafeBytes } from './indexeddb_sentinels';

export declare const SCHEMA_VERSION = 18;

export interface DbTimestamp {
    seconds: number;
    nanoseconds: number;
}

export interface DbPrimaryClient {
    ownerId: string;
    
    allowTabSynchronization: boolean;
    leaseTimestampMs: number;
}

export interface DbMutationQueue {
    
    userId: string;
    
    lastAcknowledgedBatchId: number;
    
    lastStreamToken: string;
}

export interface DbMutationBatch {
    
    userId: string;
    
    batchId: BatchId;
    
    localWriteTimeMs: number;
    
    baseMutations?: ProtoWrite[];
    
    mutations: ProtoWrite[];
}

export interface DbDocumentMutation {
}

export interface DbNoDocument {
    path: string[];
    readTime: DbTimestamp;
}

export interface DbUnknownDocument {
    path: string[];
    version: DbTimestamp;
}

export interface DbRemoteDocument {
    
    prefixPath: string[];
    
    collectionGroup: string;
    
    documentId: string;
    
    readTime: DbTimestampKey;
    
    unknownDocument?: DbUnknownDocument;
    
    noDocument?: DbNoDocument;
    
    document?: ProtoDocument;
    
    hasCommittedMutations: boolean;
}

export interface DbRemoteDocumentGlobal {
    
    byteSize: number;
}

export type DbQuery = ProtoQueryTarget | ProtoDocumentsTarget;

export interface DbTarget {
    
    targetId: TargetId;
    
    canonicalId: string;
    
    readTime: DbTimestamp;
    
    resumeToken: string;
    
    lastListenSequenceNumber: number;
    
    lastLimboFreeSnapshotVersion?: DbTimestamp;
    
    query: DbQuery;
}

export interface DbTargetDocument {
    
    targetId: TargetId;
    
    path: EncodedResourcePath;
    
    sequenceNumber?: ListenSequenceNumber;
}

export interface DbTargetGlobal {
    
    highestTargetId: TargetId;
    
    highestListenSequenceNumber: number;
    
    lastRemoteSnapshotVersion: DbTimestamp;
    
    targetCount: number;
}

export interface DbCollectionParent {
    
    collectionId: string;
    
    parent: EncodedResourcePath;
}

export interface DbClientMetadata {
    
    clientId: string;
    
    updateTimeMs: number;
    
    networkEnabled: boolean;
    
    inForeground: boolean;
}

export interface DbBundle {
    
    bundleId: string;
    
    createTime: DbTimestamp;
    
    version: number;
}

export interface DbNamedQuery {
    
    name: string;
    
    readTime: DbTimestamp;
    
    bundledQuery: BundledQuery;
}

export interface DbIndexConfiguration {
    
    indexId?: number;
    
    collectionGroup: string;
    
    fields: Array<[name: string, kind: IndexKind]>;
}

export interface DbIndexState {
    
    indexId: number;
    
    uid: string;
    
    sequenceNumber: number;
    
    readTime: DbTimestamp;
    
    documentKey: EncodedResourcePath;
    
    largestBatchId: number;
}

export interface DbIndexEntry {
    
    indexId: number;
    
    uid: string;
    
    arrayValue: KeySafeBytes;
    
    directionalValue: KeySafeBytes;
    
    orderedDocumentKey: KeySafeBytes;
    
    documentKey: string[];
}

export interface DbDocumentOverlay {
    
    userId: string;
    
    collectionPath: string;
    
    documentId: string;
    
    collectionGroup: string;
    
    largestBatchId: number;
    
    overlayMutation: ProtoWrite;
}

export interface DbGlobals {
    
    name: string;
    
    value: Uint8Array;
}
