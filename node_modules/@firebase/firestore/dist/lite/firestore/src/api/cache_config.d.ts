
import { OfflineComponentProviderFactory, OnlineComponentProviderFactory } from '../core/component_provider';

export type MemoryLocalCache = {
    kind: 'memory';
    
    _onlineComponentProvider: OnlineComponentProviderFactory;
    
    _offlineComponentProvider: OfflineComponentProviderFactory;
};

export type PersistentLocalCache = {
    kind: 'persistent';
    
    _onlineComponentProvider: OnlineComponentProviderFactory;
    
    _offlineComponentProvider: OfflineComponentProviderFactory;
};

export type FirestoreLocalCache = MemoryLocalCache | PersistentLocalCache;

export type MemoryGarbageCollector = MemoryEagerGarbageCollector | MemoryLruGarbageCollector;

export type MemoryEagerGarbageCollector = {
    kind: 'memoryEager';
    
    _offlineComponentProvider: OfflineComponentProviderFactory;
};

export type MemoryLruGarbageCollector = {
    kind: 'memoryLru';
    
    _offlineComponentProvider: OfflineComponentProviderFactory;
};

export declare function memoryEagerGarbageCollector(): MemoryEagerGarbageCollector;

export declare function memoryLruGarbageCollector(settings?: {
    cacheSizeBytes?: number;
}): MemoryLruGarbageCollector;

export type MemoryCacheSettings = {
    
    garbageCollector?: MemoryGarbageCollector;
};

export declare function memoryLocalCache(settings?: MemoryCacheSettings): MemoryLocalCache;

export type PersistentCacheSettings = {
    
    cacheSizeBytes?: number;
    
    tabManager?: PersistentTabManager;
};

export declare function persistentLocalCache(settings?: PersistentCacheSettings): PersistentLocalCache;

export type PersistentSingleTabManager = {
    kind: 'persistentSingleTab';
    
    _initialize: (settings: Omit<PersistentCacheSettings, 'tabManager'> | undefined) => void;
    
    _onlineComponentProvider?: OnlineComponentProviderFactory;
    
    _offlineComponentProvider?: OfflineComponentProviderFactory;
};

export type PersistentMultipleTabManager = {
    kind: 'PersistentMultipleTab';
    
    _initialize: (settings: Omit<PersistentCacheSettings, 'tabManager'>) => void;
    
    _onlineComponentProvider?: OnlineComponentProviderFactory;
    
    _offlineComponentProvider?: OfflineComponentProviderFactory;
};

export type PersistentTabManager = PersistentSingleTabManager | PersistentMultipleTabManager;

export type PersistentSingleTabManagerSettings = {
    
    forceOwnership?: boolean;
};

export declare function persistentSingleTabManager(settings: PersistentSingleTabManagerSettings | undefined): PersistentSingleTabManager;

export declare function persistentMultipleTabManager(): PersistentMultipleTabManager;
