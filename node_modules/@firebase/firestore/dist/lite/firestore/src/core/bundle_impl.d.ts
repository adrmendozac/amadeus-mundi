
import { LoadBundleTaskProgress } from '@firebase/firestore-types';
import { LocalStore } from '../local/local_store';
import { MutableDocument } from '../model/document';
import { DocumentKey } from '../model/document_key';
import { BundleMetadata as ProtoBundleMetadata, NamedQuery as ProtoNamedQuery } from '../protos/firestore_bundle_proto';
import { Timestamp as ApiTimestamp } from '../protos/firestore_proto_api';
import { JsonProtoSerializer } from '../remote/serializer';
import { SizedBundleElement } from '../util/bundle_reader';
import { BundleConverter, BundledDocument, BundledDocuments, BundleLoadResult } from './bundle';
import { SnapshotVersion } from './snapshot_version';

export declare class BundleConverterImpl implements BundleConverter {
    private readonly serializer;
    constructor(serializer: JsonProtoSerializer);
    toDocumentKey(name: string): DocumentKey;
    
    toMutableDocument(bundledDoc: BundledDocument): MutableDocument;
    toSnapshotVersion(time: ApiTimestamp): SnapshotVersion;
}

export declare class BundleLoader {
    private bundleMetadata;
    private serializer;
    
    private progress;
    
    private _queries;
    
    private _documents;
    
    private collectionGroups;
    constructor(bundleMetadata: ProtoBundleMetadata, serializer: JsonProtoSerializer);
    
    get queries(): ProtoNamedQuery[];
    
    get documents(): BundledDocuments;
    
    addSizedElement(element: SizedBundleElement): LoadBundleTaskProgress | null;
    private getQueryDocumentMapping;
    
    completeAndStoreAsync(localStore: LocalStore): Promise<BundleLoadResult>;
}

export declare function bundleInitialProgress(metadata: ProtoBundleMetadata): LoadBundleTaskProgress;

export declare function bundleSuccessProgress(metadata: ProtoBundleMetadata): LoadBundleTaskProgress;
