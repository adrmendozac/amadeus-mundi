
import { DataSnapshot } from '../../api/Reference_impl';
import { Repo } from '../Repo';
import { Path } from '../util/Path';
import { Change } from './Change';
import { CancelEvent, Event } from './Event';
import { QueryParams } from './QueryParams';

export interface UserCallback {
    (dataSnapshot: DataSnapshot, previousChildName?: string | null): unknown;
    userCallback?: unknown;
    context?: object | null;
}

export declare class CallbackContext {
    private readonly snapshotCallback;
    private readonly cancelCallback?;
    constructor(snapshotCallback: UserCallback, cancelCallback?: (error: Error) => unknown);
    onValue(expDataSnapshot: DataSnapshot, previousChildName?: string | null): void;
    onCancel(error: Error): void;
    get hasCancelCallback(): boolean;
    matches(other: CallbackContext): boolean;
}
export interface QueryContext {
    readonly _queryIdentifier: string;
    readonly _queryObject: object;
    readonly _repo: Repo;
    readonly _path: Path;
    readonly _queryParams: QueryParams;
}

export interface EventRegistration {
    
    respondsTo(eventType: string): boolean;
    createEvent(change: Change, query: QueryContext): Event;
    
    getEventRunner(eventData: Event): () => void;
    createCancelEvent(error: Error, path: Path): CancelEvent | null;
    matches(other: EventRegistration): boolean;
    
    hasAnyCallback(): boolean;
}
