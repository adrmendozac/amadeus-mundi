import { Repo } from '../core/Repo';
import { Path } from '../core/util/Path';
import { QueryContext } from '../core/view/EventRegistration';


export interface Query extends QueryContext {
    
    readonly ref: DatabaseReference;
    
    isEqual(other: Query | null): boolean;
    
    toJSON(): string;
    
    toString(): string;
}

export interface DatabaseReference extends Query {
    
    readonly key: string | null;
    
    readonly parent: DatabaseReference | null;
    
    readonly root: DatabaseReference;
}

export interface ThenableReference extends DatabaseReference, Pick<Promise<DatabaseReference>, 'then' | 'catch'> {
    key: string;
    parent: DatabaseReference;
}

export type Unsubscribe = () => void;

export interface ListenOptions {
    
    readonly onlyOnce?: boolean;
}
export interface ReferenceConstructor {
    new (repo: Repo, path: Path): DatabaseReference;
}
