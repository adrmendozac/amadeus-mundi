
import { CompleteFn , EmulatorMockTokenOptions , FirebaseError , NextFn , Subscribe , Unsubscribe } from '@firebase/util';
import { FirebaseApp } from '@firebase/app';

export declare function connectStorageEmulator(storage: FirebaseStorage, host: string, port: number, options?: {
    mockUserToken?: EmulatorMockTokenOptions | string;
}): void;


export declare function deleteObject(ref: StorageReference): Promise<void>;
export { EmulatorMockTokenOptions };



export declare interface FirebaseStorage {
    
    readonly app: FirebaseApp;
    
    maxUploadRetryTime: number;
    
    maxOperationRetryTime: number;
}


export declare interface FullMetadata extends UploadMetadata {
    
    bucket: string;
    
    fullPath: string;
    
    generation: string;
    
    metageneration: string;
    
    name: string;
    
    size: number;
    
    timeCreated: string;
    
    updated: string;
    
    downloadTokens: string[] | undefined;
    
    ref?: StorageReference | undefined;
}

export declare function getBlob(ref: StorageReference, maxDownloadSizeBytes?: number): Promise<Blob>;

export declare function getBytes(ref: StorageReference, maxDownloadSizeBytes?: number): Promise<ArrayBuffer>;


export declare function getDownloadURL(ref: StorageReference): Promise<string>;

export declare function getMetadata(ref: StorageReference): Promise<FullMetadata>;

export declare function getStorage(app?: FirebaseApp, bucketUrl?: string): FirebaseStorage;

export declare function getStream(ref: StorageReference, maxDownloadSizeBytes?: number): ReadableStream;



export declare function list(ref: StorageReference, options?: ListOptions): Promise<ListResult>;

export declare function listAll(ref: StorageReference): Promise<ListResult>;

export declare interface ListOptions {
    
    maxResults?: number | null;
    
    pageToken?: string | null;
}

export declare interface ListResult {
    
    prefixes: StorageReference[];
    
    items: StorageReference[];
    
    nextPageToken?: string;
}

export declare function ref(storage: FirebaseStorage, url?: string): StorageReference;

export declare function ref(storageOrRef: FirebaseStorage | StorageReference, path?: string): StorageReference;

export declare interface SettableMetadata {
    
    cacheControl?: string | undefined;
    
    contentDisposition?: string | undefined;
    
    contentEncoding?: string | undefined;
    
    contentLanguage?: string | undefined;
    
    contentType?: string | undefined;
    
    customMetadata?: {
        [key: string]: string;
    } | undefined;
}

export declare class StorageError extends FirebaseError {
    private status_;
    
    customData: {
        serverResponse: string | null;
    };
    
    constructor(code: StorageErrorCode, message: string, status_?: number);
    get status(): number;
    set status(status: number);
    
    get serverResponse(): null | string;
    set serverResponse(serverResponse: string | null);
}

export declare enum StorageErrorCode {
    UNKNOWN = "unknown",
    OBJECT_NOT_FOUND = "object-not-found",
    BUCKET_NOT_FOUND = "bucket-not-found",
    PROJECT_NOT_FOUND = "project-not-found",
    QUOTA_EXCEEDED = "quota-exceeded",
    UNAUTHENTICATED = "unauthenticated",
    UNAUTHORIZED = "unauthorized",
    UNAUTHORIZED_APP = "unauthorized-app",
    RETRY_LIMIT_EXCEEDED = "retry-limit-exceeded",
    INVALID_CHECKSUM = "invalid-checksum",
    CANCELED = "canceled",
    INVALID_EVENT_NAME = "invalid-event-name",
    INVALID_URL = "invalid-url",
    INVALID_DEFAULT_BUCKET = "invalid-default-bucket",
    NO_DEFAULT_BUCKET = "no-default-bucket",
    CANNOT_SLICE_BLOB = "cannot-slice-blob",
    SERVER_FILE_WRONG_SIZE = "server-file-wrong-size",
    NO_DOWNLOAD_URL = "no-download-url",
    INVALID_ARGUMENT = "invalid-argument",
    INVALID_ARGUMENT_COUNT = "invalid-argument-count",
    APP_DELETED = "app-deleted",
    INVALID_ROOT_OPERATION = "invalid-root-operation",
    INVALID_FORMAT = "invalid-format",
    INTERNAL_ERROR = "internal-error",
    UNSUPPORTED_ENVIRONMENT = "unsupported-environment"
}

export declare interface StorageObserver<T> {
    next?: NextFn<T> | null;
    error?: (error: StorageError) => void | null;
    complete?: CompleteFn | null;
}

export declare interface StorageReference {
    
    toString(): string;
    
    root: StorageReference;
    
    bucket: string;
    
    fullPath: string;
    
    name: string;
    
    storage: FirebaseStorage;
    
    parent: StorageReference | null;
}


export declare type StringFormat = (typeof StringFormat)[keyof typeof StringFormat];

export declare const StringFormat: {
    
    readonly RAW: "raw";
    
    readonly BASE64: "base64";
    
    readonly BASE64URL: "base64url";
    
    readonly DATA_URL: "data_url";
};

export declare type TaskEvent = 'state_changed';


export declare type TaskState = 'running' | 'paused' | 'success' | 'canceled' | 'error';

export declare function updateMetadata(ref: StorageReference, metadata: SettableMetadata): Promise<FullMetadata>;

export declare function uploadBytes(ref: StorageReference, data: Blob | Uint8Array | ArrayBuffer, metadata?: UploadMetadata): Promise<UploadResult>;

export declare function uploadBytesResumable(ref: StorageReference, data: Blob | Uint8Array | ArrayBuffer, metadata?: UploadMetadata): UploadTask;

export declare interface UploadMetadata extends SettableMetadata {
    
    md5Hash?: string | undefined;
}

export declare interface UploadResult {
    
    readonly metadata: FullMetadata;
    
    readonly ref: StorageReference;
}

export declare function uploadString(ref: StorageReference, value: string, format?: StringFormat, metadata?: UploadMetadata): Promise<UploadResult>;

export declare interface UploadTask {
    
    cancel(): boolean;
    
    catch(onRejected: (error: StorageError) => unknown): Promise<unknown>;
    
    on(event: TaskEvent, nextOrObserver?: StorageObserver<UploadTaskSnapshot> | null | ((snapshot: UploadTaskSnapshot) => unknown), error?: ((a: StorageError) => unknown) | null, complete?: Unsubscribe | null): Unsubscribe | Subscribe<UploadTaskSnapshot>;
    
    pause(): boolean;
    
    resume(): boolean;
    
    snapshot: UploadTaskSnapshot;
    
    then(onFulfilled?: ((snapshot: UploadTaskSnapshot) => unknown) | null, onRejected?: ((error: StorageError) => unknown) | null): Promise<unknown>;
}


export declare interface UploadTaskSnapshot {
    
    bytesTransferred: number;
    
    metadata: FullMetadata;
    
    ref: StorageReference;
    
    state: TaskState;
    
    task: UploadTask;
    
    totalBytes: number;
}
export {};
