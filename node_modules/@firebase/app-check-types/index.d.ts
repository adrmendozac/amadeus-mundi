

import { PartialObserver, Unsubscribe } from '@firebase/util';
import { FirebaseApp } from '@firebase/app-types';
import { Provider } from '@firebase/component';

export interface FirebaseAppCheck {
  
  app: FirebaseApp;

  
  activate(
    siteKeyOrProvider:
      | string
      | AppCheckProvider
      | CustomProvider
      | ReCaptchaV3Provider,
    isTokenAutoRefreshEnabled?: boolean
  ): void;

  
  setTokenAutoRefreshEnabled(isTokenAutoRefreshEnabled: boolean): void;

  
  getToken(forceRefresh?: boolean): Promise<AppCheckTokenResult>;

  
  onTokenChanged(observer: PartialObserver<AppCheckTokenResult>): Unsubscribe;

  
  onTokenChanged(
    onNext: (tokenResult: AppCheckTokenResult) => void,
    onError?: (error: Error) => void,
    onCompletion?: () => void
  ): Unsubscribe;
}


interface AppCheckProvider {
  
  getToken(): Promise<AppCheckToken>;
}

export class ReCaptchaV3Provider {
  
  constructor(siteKey: string);
}

export class CustomProvider {
  
  constructor(options: CustomProviderOptions);
}
interface CustomProviderOptions {
  
  getToken: () => Promise<AppCheckToken>;
}


interface AppCheckToken {
  
  readonly token: string;
  
  readonly expireTimeMillis: number;
}


interface AppCheckTokenResult {
  
  readonly token: string;
}

export type AppCheckComponentName = 'appCheck';
declare module '@firebase/component' {
  interface NameServiceMapping {
    'appCheck-compat': FirebaseAppCheck;
  }
}
