import { Identity, IdentityProvider } from "../identity/identity";
import { HandlerExecutionContext } from "../middleware";
import { HttpSigner } from "./HttpSigner";
import { IdentityProviderConfig } from "./IdentityProviderConfig";

export type HttpAuthSchemeId = string;

export interface HttpAuthScheme {
    
    schemeId: HttpAuthSchemeId;
    
    identityProvider(config: IdentityProviderConfig): IdentityProvider<Identity> | undefined;
    
    signer: HttpSigner;
}

export interface HttpAuthOption {
    schemeId: HttpAuthSchemeId;
    identityProperties?: Record<string, unknown>;
    signingProperties?: Record<string, unknown>;
    propertiesExtractor?: <TConfig extends object, TContext extends HandlerExecutionContext>(config: TConfig, context: TContext) => {
        identityProperties?: Record<string, unknown>;
        signingProperties?: Record<string, unknown>;
    };
}

export interface SelectedHttpAuthScheme {
    httpAuthOption: HttpAuthOption;
    identity: Identity;
    signer: HttpSigner;
}
